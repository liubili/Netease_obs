# Netease OBS 歌曲信息同步脚本

## 简单 · 实用

本项目是一个 OBS 脚本插件，专为 Windows 版网易云音乐用户设计。它可以自动获取当前播放的歌曲信息，并实时写入本地文件，方便在直播或录屏时展示当前歌曲信息。相比一些复杂的方案，本脚本更易用，配置简单。

> ⚠️ 封面功能尚未完善，当前版本仅保证歌曲信息写入功能可用。

## 关于

本脚本通过调用 Windows API 和 Python 库，检测网易云音乐主窗口并提取歌曲名。支持自定义刷新间隔、文件路径、前缀等参数，适合有基础自动化需求的主播和内容创作者。

## 功能简介

- 自动检测网易云音乐主窗口，获取当前播放歌曲名
- 支持 OBS 参数自定义（刷新间隔、文件路径、前缀等）
- 支持 Debug 模式，输出所有窗口详细信息，方便排查问题
- 兼容 Windows 系统
- 支持自定义“当前播放”前缀（如“Now Playing”、“正在播放”等）

## 使用方法

1. **环境准备**
    - Python 3.7+
    - 安装依赖：
      ```shell
      pip install pywin32 psutil requests lxml
      ```

2. **将 `main.py` 添加到 OBS 脚本管理器**
    - 打开 OBS → 工具 → 脚本 → 添加 `main.py`

3. **参数设置**
    - 在 OBS 脚本界面可自定义：
        - 刷新间隔（秒）
        - 是否启用封面获取（暂未完善）
        - 是否开启 Debug 模式
        - 歌曲信息文件路径
        - 封面图片保存路径
        - 歌曲信息前缀（如“当前播放”、“Now Playing”等）

4. **在 OBS 中引用**
    - 使用文本源读取 `song.txt`，即可实时展示当前歌曲信息。

## 参数说明

| 参数名         | 说明                   | 默认值                                   |
| -------------- | ---------------------- | ---------------------------------------- |
| refresh_rate   | 刷新间隔（秒）         | 5                                        |
| enable_cover   | 是否启用封面获取       | True（但功能未完善）                      |
| debug_mode     | 是否输出所有窗口标题   | False                                    |
| txt_file       | 歌曲信息文件路径       | F:\Program Files\Netmusic\song.txt       |
| cover_file     | 封面图片保存路径       | F:\Program Files\Netmusic\cover.jpg      |
| custom_prefix  | 歌曲信息前缀           | 当前播放                                  |

## 注意事项

- **封面功能尚未完善，暂不建议依赖该功能。**
- 若无法获取歌曲信息，请确保网易云音乐已打开且为主窗口，可开启 Debug 模式辅助排查。
- OBS 需有权限访问指定的文件路径。
- 如需自定义前缀，请在 OBS 脚本参数中填写，留空则默认为“当前播放”。

## 贡献

欢迎提交 Issue 或 PR，帮助完善脚本功能。
